/*! financing_clearing_system v1.0.0
*  by [object Object]
*  (c) 2014-2016 www.frontpay.cn
* updated on 2016-11-14
*  Licensed under Apache-2.0
*/
 function showPDFModal(title,url){$("#modal-agreement-doc").iframeModal({title:title,url:url})}function hidePDFModal(){$("#modal-agreement-doc").iframeModal("hide")}var Spine=function(){var e=function(){var h=function(j,i){for(var k in i)i.hasOwnProperty(k)&&(j[k]=i[k])},f=function(){function l(){!l.initPrototype&&this.init&&this.init.apply(this,arguments)}this.initPrototype=!0;var j=new this;this.initPrototype=!1;for(var k,i=Array.prototype.slice.call(arguments)||[];k=i.shift();)h(j,k.prototype||k);return l.prototype=j,l.prototype.constructor=l,l.extend=f,l},g=function(){};return g.extend=f,g}(),c=function(j,h){if(null===j)return-1;for(var f=0,g=j.length;f<g;f++)if(j[f]===h)return f;return-1},a=e.extend({on:function(f,g){return this.__events||(this.__events={}),this.__events[f]||(this.__events[f]=[]),c(this.__events,g)===-1&&"function"==typeof g&&this.__events[f].push(g),this},fire:function(j){if(this.__events&&this.__events[j]){var g=Array.prototype.slice.call(arguments,1)||[],k=this.__events[j],h=0,f=k.length;for(h;h<f;h++)k[h].apply(this,g);return this}},off:function(g,i){if(g||i||(this.__events={}),g&&!i&&delete this.__events[g],g&&!i)var h=this.__events[g],f=c(h,i)(f>-1)&&h.splice(f,1);return this}}),b=e.extend(a,{init:function(f){this.__config=f,this.bind(),this.render()},get:function(f){return this.__config[f]},set:function(f,g){this.__config[f]=g},bind:function(){},render:function(){},destroy:function(){this.off()}}),d=b.extend({EVENTS:{},template:"",init:function(f){this.__config=f,this._delegateEvent(),this.initialize()},_delegateEvent:function(){var l,k,g,j,h=this,i=this.EVENTS||{},f=this.get("parentNode")||$(document.body);for(g in i){l=i[g];for(j in l)k=l[j],function(m){f.on(j,g,function(o){var n=[].slice.call(arguments);n.unshift(h),m.apply(this,n)})}(k)}},_parseTemplate:function(h,g){var f=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+h.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return g?f(g):f},initialize:function(){this.render()},setChuckdata:function(i,k){var g=this,j=g.get("__renderData");if(j[i]=k,this.template){var f=$(g._parseTemplate(this.template,j)),h=g.get("__currentNode");h&&(h.replaceWith(f),g.set("__currentNode",f))}},render:function(j){var g=this;if(g.set("__renderData",j),this.template){var i=g._parseTemplate(this.template,j),f=this.get("parentNode")||$(document.body),h=$(i);g.set("__currentNode",h),f.append(h)}},destroy:function(){var h=this;h.off(),h.get("__currentNode").remove();var l,k,g,j,i=h.EVENTS||{},f=h.get("parentNode");for(g in i){l=i[g];for(j in l)k=l[j],f.off(j,g,k)}}});return d}(),PartialView=Spine.extend({initialize:function(){this.$el=this.get("parentNode"),this.template=this.get("template").html(),this.EVENTS=this.get("EVENTS"),this._delegateEvent()},render:function(data){data=data||{};var template=this._parseTemplate(this.template,data);this.$el.empty().append(template)}}),successModalLayer=function($){return function(config){var id=config.id?config.id:"#j-modal-status";$(id).modalLayer({icon:"success",title:config.title||"",content:config.content||"",buttons:[{text:"确认",ok:function(){config&&"string"==typeof config.link&&(location.href=config.link),config&&"function"==typeof config.callback&&config.callback()}}]})}}(jQuery),confirmModalLayer=function($){return function(config){var id=config.id?config.id:"#confirmModalLayer";$(id).modalLayer({icon:"info",title:config.title||"",content:config.content||"",buttons:[{text:"确定",ok:config.callback},{text:"取消",style:"btn secondary fn-ml-10"}]})}}(jQuery),alertModalLayer=function($){return function(config){var id=config.id?config.id:"#alertModalLayer";$(id).modalLayer({icon:config.icon||"info",title:config.title||"",content:config.content||""})}}(jQuery),closeModalLayer=function($){return function(id,fn){$(id).modal("hide").on("hide.ui.modal",function(){$(this).remove(),"function"==typeof fn&&fn()})}}(jQuery),treeCheck=function($){var app={init:function(){var $checkAll=$("#j-checkAll"),$permission=$("#j-permission");this.$permission=$permission,this.checkAll($checkAll,$permission),this.childrenCheck($permission),this.parentCheck()},checkAll:function(obj,target,context){$(obj).on("click",function(){var $checkboxs,parent,isChecked=$(this).is(":checked");parent=context?$(this).closest("li").find(target):target,$checkboxs=$(parent).find(":checkbox"),$checkboxs.prop("checked",isChecked)})},childrenCheck:function(obj){var $checkAll=$(obj).find("h4").find(":checkbox");this.checkAll($checkAll,"ul",obj)},parentCheck:function(){var bubble=function(obj){var ul,h4,preUL;ul=$(obj).closest("ul"),h4=ul.prev("h4"),preUL=ul.parentsUntil("ul"),0!==ul.length&&0!==h4.length&&(h4.length>0&&h4.find(":checkbox").prop("checked",!0),preUL.length>0&&bubble(preUL))},checkCancel=function(obj){var ul,h4,checks;ul=$(obj).closest("ul"),h4=ul.prev("h4"),checks=ul.find(":checked"),0===checks.length&&h4.find(":checkbox").prop("checked",!1)};this.$permission.on("click","li ul li :checkbox",function(){if(!($(this).parents(".t-tree-table").length>0)){var isChecked=$(this).is(":checked");isChecked?bubble(this):checkCancel(this)}})},toChildren:function(){var hiddenChildrenMenu=function(){$(".has-children").removeClass("has-children-open")};this.$permission.on("click",".has-children :checkbox",function(e){var $grandpa=$(this).parent().parent();hiddenChildrenMenu(),$grandpa.addClass("has-children-open"),e.stopPropagation()}),$(document).on("click.hide.tree-children",hiddenChildrenMenu),$(".tree-drop-children").on("click",function(ev){ev.stopPropagation()})}};return app}(jQuery),treeDrop=function($){function TreeDrop(el){this.el=$(el),this._init()}TreeDrop.prototype._init=function(){this.el.on("click",$.proxy(this.show,this)),this.el.on("click",'[data-dismiss="treedrop"]',$.proxy(this.hide,this))},TreeDrop.prototype.show=function(){this.el.addClass("active")},TreeDrop.prototype.hide=function(e){this.el.removeClass("active").find(":checkbox").prop("checked",!1),e&&e.stopPropagation()};var handler={init:function(){$(".tree-drop").each(function(){var that=$(this),data=that.data("treedrop");data||that.data("treedrop",new TreeDrop(that))})},hide:function(instance){var obj=$(instance?instance:".tree-drop");obj.each(function(){var data=$(this).data("treedrop");data&&data.hide()})}};return function(method,instance){method=method||"init",handler[method]&&handler[method](instance)}}(jQuery),toogleDrop=function($){var handler={init:function(selector){this.el=$(selector),this.target=$($(this.el).attr("data-target")),this.bind()},ready:function(selector){var that=this;$(document).ready(function(){that.init(selector)})},bind:function(){var that=this;this.el.length&&this.target.length&&this.el.on("click",function(e){e.preventDefault();var data=$(this).data(),active=!!data.active&&data.active;active&&that.target.toggleClass(active),$(this).toggleClass("active")})}};return handler.ready('[data-toggle="accordion"]'),function(selector){handler.init(selector)}}(jQuery),alertDeleteWork=function(){return function(e){var url=$(this).attr("href"),title=$(this).attr("rel")||"";return confirmModalLayer({title:"是否删除"+(title?' <b class="warning-FontColor">'+title+"</b> ":"")+"此工作流记录？",callback:function(){location.href=url}}),e&&e.preventDefault(),!1}}(jQuery),alertDeleteAdmin=function(){return function(e){var title=($(this).attr("href"),$(this).attr("rel")||"");$(this).attr("data-mid");return confirmModalLayer({title:"关闭"+(title?' <b class="warning-FontColor">'+title+"</b> ":"")+"？",callback:function(){successModalLayer({title:"操作成功",callback:function(){location.reload()}})}}),e&&e.preventDefault(),!1}}(jQuery),alertFreeAdmin=function(){return function(e){var title=($(this).attr("href"),$(this).attr("rel")||"");return confirmModalLayer({title:"开启"+(title?' <b class="warning-FontColor">'+title+"</b> ":"")+"？",callback:function(){successModalLayer({title:"操作成功",callback:function(){location.reload()}})}}),e&&e.preventDefault(),!1}}(jQuery);~function($){function dialogApi(selector,opt,next){this.selector=selector,this.next=next,this.dialog=this.get(selector),this.showModal(opt)}dialogApi.prototype.showModal=function(opt){var that=this;opt.show=!1,opt.content="",opt.callback=function(){that.dialog=$(that.selector),that.$dom=$(this),opt&&opt.url&&(that.originalUrl=opt.url,that.init(),"function"==typeof that.next&&that.next.call(that,that.$dom))},that.dialog.modal(opt)},dialogApi.prototype.init=function(){var $body=this.$dom.find(".modal-body");this.$title=this.$dom.find(".modal-title"),this.$iframe=$("<iframe />"),this.$iframe.attr({src:this.originalUrl,width:"100%",height:"100%",allowtransparency:"yes",frameborder:"no",scrolling:"no"}).on("load",$.proxy(this.adjustHeight,this)),$body.empty().append(this.$iframe)},dialogApi.prototype.setProp=function(config){config.title&&this.$title.html(config.title),config.url&&(this.$iframe[0].src=config.url)},dialogApi.prototype.adjustHeight=function(){var test,h;this.$iframe.css({height:"0px"});try{test=this.$iframe[0].contentWindow.frameElement}catch(e){}test&&(h=this.$iframe.contents().height(),this.$iframe.css({height:h+"px"}))},dialogApi.prototype.show=function(){this.dialog.modal("show")},dialogApi.prototype.hide=function(){this.dialog.modal("hide")},dialogApi.get=dialogApi.prototype.get=function(id){if(id&&id.frameElement){var api,iframe=id.frameElement,modalList=$(".modal-background",id.parent.document);return modalList.each(function(i,item){var ifr=$(item).find("iframe");ifr[0]===iframe&&(api=$(item))}),api}return $(id)},dialogApi.close=function(id){var dialog=dialogApi.get(id);$(dialog).find(".modal-close").trigger("click"),$(dialog).remove()},dialogApi.adjustHeight=function(id){var test,h,dialog=dialogApi.get(id),$iframe=$(dialog).find("iframe");try{test=$iframe[0].contentWindow.frameElement}catch(e){}test&&(h=$iframe.contents().height(),$iframe.css({height:h+"px"}))},$.fn.iframeModal=function(opt,args){var that=$(this),selector=$(this).selector;if((this[0]===window||this[0]===parent)&&"hide"==opt)return void dialogApi.close(window);if(this[0]===window&&"adjustHeight"==opt)return void dialogApi.adjustHeight(window);var data=that.data("ui.iframeModal");data?($.isPlainObject(opt)&&data.setProp(opt),data&&data.show()):data=new dialogApi(selector,opt,function(obj){$(obj).data("ui.iframeModal",this)}),"string"==typeof opt&&data[opt]&&data[opt](args)}}(jQuery);var Accordion=function($){var Handler={init:function(obj,target){this.$obj=$(obj),this.target=target,this.onEvent()},onEvent:function(){var that=this;this.$obj.on("click",function(){that.toggle($(this))})},toggle:function($obj){var target=$obj.next(this.target),isOpen=$obj.data("isOpen");isOpen?(target.hide(),$obj.data("isOpen",!1).removeClass("j-accordion-open")):(target.show(),$obj.data("isOpen",!0).addClass("j-accordion-open"))}};return function(obj,target){Handler.init(obj,target)}}(jQuery),formatJSON=function($){return function(arr){var temp,val,ret={},key="",name="";if(arr&&arr.length)for(var i=0,l=arr.length;i<l;i++)name=arr[i].name,val=arr[i].value,name.indexOf("[]")>-1?(key=name.split("[]")[0],ret[key]||(ret[key]=[])):key=name,arr[i]&&key&&(ret[key]?$.isArray(ret[key])?ret[key].push(val):(temp=ret[key],ret[key]=[temp,val]):ret[key]=val);return ret}}(jQuery),inputInsert=function($){function insertAtCaret(elem,text){var sel,startPos,endPos,scrollTop;elem&&(document.selection?(elem.focus(),sel=document.selection.createRange(),sel.text=text,elem.focus()):"number"==typeof elem.selectionStart?(startPos=elem.selectionStart,endPos=elem.selectionEnd,scrollTop=elem.scrollTop,elem.value=elem.value.substring(0,startPos)+text+elem.value.substr(endPos,elem.value.length),elem.focus(),elem.selectionStart=startPos+text.length,elem.selectionEnd=startPos+text.length,elem.scrollTop=scrollTop):(elem.value+=text,elem.focus()))}return insertAtCaret}(jQuery);!function($){var Secret=function(el,option){this.$el=$(el),this.isShow=!1,this.option=$.extend({},Secret.DEFAULTS,this.$el.data(),option),this.$target=$(this.option.target),this.$target.length||(this.$target=this.$el.prev()),this.chkDomType()};Secret.DEFAULTS={target:"",front:3,behind:4,"char":"*"},Secret.prototype={chkDomType:function(){this.isInput="INPUT"===this.$target[0].tagName.toUpperCase()},show:function(){var e=$.Event("secret.show");this.$el.trigger(e),this.isShow=!0,this.transfer()},hide:function(){var e=$.Event("secret.hide");this.$el.trigger(e),this.isShow=!1,this.transfer()},toggle:function(){this.isShow=!this.isShow,this.transfer()},transfer:function(){var original=this.$target.attr("data-original"),startLen=this.option.front,endLen=this.option.behind,char=this.option["char"],strLen=0,charLen=0,tempArr=[];if(original){if(!this.isShow){if(strLen=original.length,charLen=strLen-startLen-endLen+1,charLen<0)return;tempArr=new Array(charLen),original=0===endLen?original.slice(0,startLen)+tempArr.join(char):original.slice(0,startLen)+tempArr.join(char)+original.slice(-endLen),this.update(original)}this.update(original)}},update:function(str){this.$target[this.isInput?"val":"html"](str),this.$el.html(this.isShow?"隐藏":"查看")}};var Handler=function(option){return $(this).each(function(){var that=$(this),data=that.data("ui.secret");data||that.data("ui.secret",data=new Secret(that,option)),"string"==typeof option&&data[option]&&data[option]()})};$.fn.secret=Handler,$(function(){$(document).on("click.secret",function(e){var that=e.target;$(that).is('[data-toggle="secret"]')&&(e.preventDefault(),Handler.call(that,"toggle"))})})}(jQuery),function($){$.fn.fixPlaceholder=function(){return $(this).each(function(){var oLabel=$(this).prev(".form-placeholder");oLabel.length&&oLabel.remove()})},$(function(){$("input[placeholder]").fixPlaceholder()})}(jQuery),function($){function selectValue(){var type,thisVal=$(this).val(),$target=$($(this).attr("data-target"));$target.length&&(type="INPUT"===$target[0].tagName.toUpperCase()?"val":"html",$target[type](thisVal))}$(function(){$('[data-toggle="select"]').on("change",selectValue).trigger("change")})}(jQuery),function($){function dateDiff(){var sVal,eVal,sTime,eTime,diff,type,prop,$target=$($(this).attr("data-target")),$partner=$($(this).attr("data-partner")),sArr=[],eArr=[];$target.length&&$partner.length&&(sVal=$partner.val(),eVal=$.trim($(this).val()),type=$(this).attr("data-type"),prop="INPUT"===$target[0].tagName.toUpperCase()?"val":"html",sVal&&eVal&&(sArr=sVal.split("-"),eArr=eVal.split("-"),sTime=0==type?new Date(eArr[0],parseInt(eArr[1],10)-1,eArr[2],0,0,0):new Date(sArr[0],parseInt(sArr[1],10)-1,sArr[2],0,0,0),eTime=0==type?new Date(sArr[0],parseInt(sArr[1],10)-1,sArr[2],0,0,0):new Date(eArr[0],parseInt(eArr[1],10)-1,eArr[2],0,0,0),diff=Math.floor((eTime-sTime)/864e5),$target[prop](diff)))}$(function(){$('[data-toggle="datetimepicker"][data-plugin="datediff"]').on("choose.ui.datetimepicker",dateDiff)})}(jQuery),function($){function multiSelect(){var self=$(this),$grandpa=self.parent().parent(),$select=self.parents(".form-control-dropdown"),$input=$select.find(".form-control");setMultiSelect($grandpa,$input,$select)}function setMultiSelect(list,target,el){var $p,t,$checkeds=list.find("input").filter(":checked"),data=[],v=[],character=target.attr("data-char")||";";$checkeds.map(function(i,item){$p=$(item).next("span"),t=$.trim($p.text()),v.push(t),data.push({value:$(item).val(),title:v})});var evt=$.Event("check.ui.dropdown",{relatedTarget:$checkeds});el.trigger(evt),target.val(v.join(character))}function stopEvt(e){e.stopPropagation()}$(function(){$(document).on("click",".dropdown-multi .form-control-dropdown-menu",stopEvt),$(document).on("click",".dropdown-multi :checkbox",multiSelect)})}(jQuery),function($){function setEndTime(el,date){$(el).val(date).attr("data-min",date)}function Plugin(){return $(this).each(function(){var that=$(this),$start=$(that.attr("data-start")),startDate="";$start.length&&(startDate=$start.val(),setEndTime(that,startDate),$start.on("choose.ui.datetimepicker",function(e,date){setEndTime(that,date)}))})}$.fn.endTimePicker=Plugin,$('[data-plugin="endTimePicker"]').endTimePicker()}(jQuery),$(function(){function setDropdownDefault(e,li){var $val=$(this).siblings(".data-val"),$title=$(this).siblings(".data-title"),val=$(li).data("val"),title=$(li).attr("title");$val.length&&$val.val(val),$title.length&&$title.val(title)}Accordion(".j-accordion-btn",".j-accordion"),$(document).on("click",".j-delete-work",alertDeleteWork),$(document).on("click",".j-remove-admin",alertDeleteAdmin),$(document).on("click",".j-free-admin",alertFreeAdmin),$("form").attr("autocomplete","off"),$('.form-control-dropdown-value,[data-toggle="dropdown"]').on("selected",function(e){var matchElem,that=$(this),selectedItem=that.attr("title")||that.val(),$lis=that.next(".form-control-dropdown-menu").find("li");selectedItem&&(matchElem=$lis.filter('[title="'+selectedItem+'"]'),matchElem.trigger("click"),setDropdownDefault.call(that,e,matchElem))}).trigger("selected").on("selected.ui.dropdown",setDropdownDefault)});var Util={};Util={zeroTen:function(d){return d>10?d:"0"+d},datediff:function(d,diff){var date=new Date(d),diffDay=date.getTime()+86400*diff*1e3,dd=new Date(diffDay);return dd.getFullYear()+"-"+Util.zeroTen(dd.getMonth()+1)+"-"+Util.zeroTen(dd.getDate())},currency:function(num,decimal){decimal=decimal||2;var parts,n=Number(num);return isNaN(n)?num:(n=Number(num).toFixed(decimal),parts=n.split("."),parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+"."+(parts[1]||""))}};