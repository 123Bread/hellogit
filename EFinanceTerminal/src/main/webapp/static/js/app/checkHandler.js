/*! financing_clearing_system v1.0.0
*  by [object Object]
*  (c) 2014-2016 www.frontpay.cn
* updated on 2016-11-14
*  Licensed under Apache-2.0
*/
 !function(root,$){var CheckHandler=function(obj,option){this.$el=$(obj),this.uuid="#CheckModal_"+ +new Date,this.config=option,this.init()},cnArr=["零","一","二","三","四","五","六","七","八","九","十"];CheckHandler.prototype={constructor:CheckHandler,init:function(){return this.config.uid&&this.config.url?(this.show(),void $(this.uuid).on("click",".j-btn-sure",$.proxy(this.ajax,this))):void console.warn("uid或url未设置！")},show:function(){var content=this.render();$(this.uuid).modal({title:"请确认审核级别",content:content})},render:function(){var i=1,data=this.$el.data(),level=data.level,belong=data.belong,_html=[],id=this.$el.val();if(level&&id){for(_html.push("<form>"),_html.push('<input type="hidden" name="id" value="'+id+'"  />'),_html.push('<input type="hidden" name="uid" value="'+this.config.uid+'"  />'),_html.push('<ul class="check-level-list">'),_html.push('<li><label><input type="radio" '+(belong?"":'checked="checked"')+' name="checkLevel" value="0" />无</label></li>');i<=level;i++)_html.push('<li><label><input type="radio" '+(belong===i?'checked="checked"':"")+' name="checkLevel" value="'+i+'" />'+cnArr[i]+"级审核</label></li>");_html.push("</ul>"),_html.push("</form>"),_html.push('<div class="text-align-center margin-top-40px"><div class="btn-with-viceLink text-align-center plural-btns"><button type="button" class="btn primary j-btn-sure">确认</button><a href="###" class="btn-vicelink" data-dismiss="modal">取消</a></div></div>')}return _html.join("")},ajax:function(){var that=this,$form=$(this.uuid).find("form").eq(0),checkedLen=$form.find(":checked").length,data=$form.serialize(),level=data.match(/checkLevel=(\d+)/)[1];if(!checkedLen)return void alertModalLayer({title:"请选择审核级别!"});var res={status:1,msg:""};1===res.status?($(that.uuid).modal("hide"),level>0&&successModalLayer({title:"成功添加审核权限！"}),that.check(level)):alertModalLayer({icon:"error",title:"设置失败"})},check:function(level){level=parseInt(level);var $span=this.$el.parent().next("span");level>0?(this.$el.prop("checked",!0).data("belong",level),$span.length>0?$span.html("（"+cnArr[level]+"级审核）"):this.$el.parent().after("<span>（"+cnArr[level]+"级审核）</span>")):(this.$el.prop("checked",!1).data("belong",level),$span.remove()),"function"==typeof this.config.callback&&this.config.callback()}};var Handler=function(option){return $(this).on("click",function(e){e.preventDefault();var instance=$(this).data("checkHandler");instance?instance.show():$(this).data("checkHandler",instance=new CheckHandler(this,option))})};$.fn.checkHandler=Handler}(window,jQuery);